#!/bin/bash

AFF3CT_PATH=@CMAKE_INSTALL_PREFIX@/bin

ls -l $AFF3CT_PATH/aff3ct-* > /dev/null 2>&1

if [ $? -gt 0 ]; then
	echo "There is no AFF3CT binary installed on the system (AFF3CT_PATH='$AFF3CT_PATH')."
	exit 1
fi

BIN=$(ls -l $AFF3CT_PATH/aff3ct-* | tail -n 1 | cut -d" " -f10)

STR=$($BIN "$@" 2>&1)
if [[ $STR == *"mkl_intel"*".so: cannot open shared object file"* ]]; then
	source @INTEL_ROOT@/vars-intel.sh
fi

eval $BIN "$@"